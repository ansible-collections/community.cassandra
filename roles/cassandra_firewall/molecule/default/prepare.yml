---
- name: Prepare
  hosts: all

  tasks:

    - name: Clean package manager cache
      ansible.builtin.shell: dnf clean all || yum clean all
      when: ansible_facts['os_family'] == 'RedHat'
      
    - name: Clean package manager cache
      ansible.builtin.shell: apt-get update && apt-get clean
      when: ansible_facts['os_family'] == 'Debian'

    - name: Run fix firewalld script on RedHat based systems
      ansible.builtin.script: ../files/firewalld_fix.sh
      when: ansible_os_family == "RedHat"
